@using ShopAdmin.Common
@using ShopAdmin.Helper
@model Collection

<section class="" data-id="@Model.Id">
    <div class="container">
        
        <div class="">
            <div><img src="@Model.Thumbnail" alt="@Model.Name" /></div>
            <div class="collection-description">
                @Html.Raw(Model.Description)
            </div>
        </div>

        <h2 class="text-center">Danh sách sản phẩm</h2>
        @if (!Model.Products.Any())
        {
            <div>
                <span>Không tìm thấy sản phẩm nào thuộc bộ sưu tập này</span>
            </div>
        }
        else
        {
            <div class="products-grid" id="productsGrid">

                @foreach (var product in Model.Products)
                {
                    var isSaleOff = product.PriceDiscount.HasValue && product.PriceDiscount > 0;

                    <div class="product-card fade-in" data-product="@product.Id" data-name="@(SlugHelper.GenerateSlug(product.Name))">
                        <div style="position: relative;">
                            <img src="@(product.Images.FirstOrDefault()?.ImageUrl)" alt="@product.Name" class="product-image">
                            @if (isSaleOff)
                            {
                                <div class="product-badge badge-sale">SALE</div>
                            }
                        </div>
                        <div class="product-info">
                            <h3 class="product-name">@product.Name</h3>
                            <div class="product-price">
                                @if (isSaleOff)
                                {
                                    <span class="original-price">@(product.Price.ToStringNumber())&nbsp;₫</span>
                                    <span class="current-price">@(product.PriceDiscount.ToStringNumber())&nbsp;₫</span>
                                }
                                else
                                {
                                    <span class="current-price">@(product.Price.ToStringNumber())&nbsp;₫</span>
                                }
                            </div>
                            @* <div class="product-rating">
                    <span class="stars">★★★★☆</span>
                    <span class="rating-text">(203 đánh giá)</span>
                    </div> *@
                            @*  <button class="add-to-cart-btn">Thêm vào giỏ</button> *@
                        </div>
                    </div>
                }
            </div>
        }

    </div>
</section>

@section scripts {
    <script>
        $('.product-card').off('click').on('click', function () {
            let id = $(this).data('product');
            let name = $(this).data('name');
            window.location = `/${name}-p${id}`;
        })
    </script>
}